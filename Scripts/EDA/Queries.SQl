-- Retrieve a list of unique countries from which customers originate


SELECT DISTINCT COUNTRY FROM gold.dim_customers;


-- Retrieve a list of unique categories, subcategories, and products

SELECT DISTINCT 
    category, 
    subcategory, 
    product_name 
FROM gold.dim_products
ORDER BY category, subcategory, product_name;


-- Determine the first and last order date and the total duration in months

SELECT 
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date,
    DATEDIFF(MONTH, MIN(order_date), MAX(order_date)) AS order_range_months
FROM gold.fact_sales;


-- Find the youngest and oldest customer based on birthdate

SELECT 
MIN(birthdate) as oldest,
DATEDIFF(year,MIN(birthdate),getdate()) as oldest_age,
MAX(birthdate) as youngest,
DATEDIFF(year,max(birthdate),getdate()) as youngest_age
from gold.dim_customers;



-- Total customers by country!

SELECT 
Country,
count(customer_key) as total_customers
from gold.dim_customers
group by country
order by count(customer_key) desc;

-- find total customer by gender - ?
SELECT
gender,
Count(customer_key) as total_customers
from gold.dim_customers
group by gender;

-- Find total products by category ?
SELECT 
Category,
Count(product_key) as total_prod_count
from gold.dim_products
group by 
Category

-- What is the avg and total revenue generated by each category

SELECT
p.Category,
avg(p.cost) total_cost_by_cat,
sum(f.sales_amount) total_sales_by_cat
from gold.dim_products p
left join gold.fact_sales f
on p.product_key = f.product_key
group by
p.category
Order by total_sales_by_cat desc;

-- What is the total revenue generated by each customer
SELECT
c.customer_key,
c.first_name,
sum(f.sales_amount) as total_sales_by_cust
from gold.dim_customers c
left join gold.fact_sales f
on c.customer_key  = f.customer_key
group by c.customer_key,c.first_name
order by total_sales_by_cust desc;

-- What is the distribution of sold items across countries ?

SELECT
c.Country,
sum(f.quantity)
from gold.dim_customers c
left join gold.fact_sales f
on c.customer_key = f.customer_key
group by c.Country;




-- Which 5 products generate the Highest revenue ?

SELECT top 5 p.product_name,
sum(f.sales_amount) as total_sales_prod
from gold.dim_products p
left join gold.fact_sales f
on p.product_key = f.product_key
group by p.product_name
order by sum(f.sales_amount) desc;

-- Find the top 10 Customers who have generated the highest revenue

-- cust_key, first_name,last_name

SELECT TOP 10
c.customer_key,
c.first_name,
c.last_name,
sum(f.sales_amount)
from gold.dim_customers c
left join gold.fact_sales f
on c.customer_key = f.customer_key
group by 
c.customer_key,
c.first_name,
c.last_name
order by sum(f.sales_amount) desc



-- Generat a report that shows all key metrics of the business

SELECT 'Total sales' as measure_name, SUM(sales_amount) as measure_value from gold.fact_sales
union
SELECT 'Average price' as measure_name, avg(price) as measure_value from gold.fact_sales
union
SELECT 'Total Qty' as measure_name,  SUM(quantity) as measure_value from gold.fact_sales
union
SELECT 'Total Orders' as measure_name, count(DISTINCT Order_number) as measure_value from gold.fact_sales
union
SELECT 'Total Products' as measure_name, count(DISTINCT product_name) as measure_value from gold.dim_products
union
SELECT 'Total Customer' as measure_
